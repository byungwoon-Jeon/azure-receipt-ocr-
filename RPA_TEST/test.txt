import os
import logging
from PyPDF2 import PdfReader, PdfWriter

# 로깅 설정
logging.basicConfig(level=logging.INFO, format="%(asctime)s - %(levelname)s - %(message)s")

def split_pdf_by_pages(input_pdf: str, output_dir: str) -> None:
    """
    PDF 파일을 페이지 단위로 분할하여 각각 저장합니다.

    Args:
        input_pdf (str): 분할할 대상 PDF 파일 경로
        output_dir (str): 분할된 PDF를 저장할 폴더 경로
    """
    try:
        if not os.path.exists(input_pdf):
            raise FileNotFoundError(f"PDF 파일이 존재하지 않습니다: {input_pdf}")
        
        os.makedirs(output_dir, exist_ok=True)
        reader = PdfReader(input_pdf)

        logging.info(f"총 {len(reader.pages)} 페이지 발견")

        for page_num, page in enumerate(reader.pages, start=1):
            writer = PdfWriter()
            writer.add_page(page)

            output_file = os.path.join(output_dir, f"page_{page_num}.pdf")
            with open(output_file, "wb") as f:
                writer.write(f)

            logging.info(f"{page_num} 페이지 저장 완료 -> {output_file}")

        logging.info("PDF 분할 완료")

    except Exception as e:
        logging.error(f"PDF 분할 중 오류 발생: {e}", exc_info=True)


if __name__ == "__main__":
    input_pdf_path = "example.pdf"      # 분할할 PDF 경로
    output_directory = "output_pages"   # 결과 저장 폴더
    split_pdf_by_pages(input_pdf_path, output_directory)