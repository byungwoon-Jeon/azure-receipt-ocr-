# 1) ë„ˆë¬´ ì‘ì€/ë¹„ì •ìƒ ë¹„ìœ¨ ì œê±°
kept = []
img_area = (img_w * img_h) if (img_w and img_h) else None
removed_small = 0; removed_aspect = 0
for b in boxes:
    w = b[2]-b[0]; h = b[3]-b[1]
    if w <= 5 or h <= 5:
        removed_small += 1; continue
    if img_area and ((w*h) / img_area) < min_area_ratio:
        removed_small += 1; continue
    ar = h / (w + 1e-9)
    if not (aspect_min <= ar <= aspect_max):
        removed_aspect += 1; continue
    kept.append(b)

# ğŸ”§ ëª¨ë‘ ì‚¬ë¼ì§€ë©´ ì™„í™” íŒŒë¼ë¯¸í„°ë¡œ ì¦‰ì‹œ ì¬í†µê³¼
if not kept:
    kept = []
    for b in boxes:
        w = b[2]-b[0]; h = b[3]-b[1]
        # ìµœì†Œ í”½ì…€ ê¸°ì¤€ë§Œ ì ìš©í•˜ê³  ë©´ì /ì¢…íš¡ë¹„ëŠ” ì ì‹œ ìŠ¤í‚µ
        if w <= 3 or h <= 3:
            continue
        kept.append(b)