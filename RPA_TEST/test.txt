def deduplicate_rows_by_certification_number(columns, data_rows):
    """
    certification_number 기준으로 중복 row 제거.
    - 첫 번째만 keep
    - 그 이후 동일 certification_number면 drop
    - certification_number 값이 없거나 ""/None이면 dedup 안 하고 그냥 keep
    """
    KEY_COL = "certification_number"

    if KEY_COL not in columns:
        # 컬럼 자체가 없으면 그냥 원본 반환
        return data_rows

    key_idx = columns.index(KEY_COL)
    seen = set()
    deduped = []

    for row in data_rows:
        # 방어: row 길이가 columns보다 짧을 수도 있으니 체크
        if not isinstance(row, list) or key_idx >= len(row):
            deduped.append(row)
            continue

        cert_val = row[key_idx]

        # None이나 빈 문자열은 유일 취급 (즉 그냥 keep)
        if cert_val is None or (isinstance(cert_val, str) and cert_val.strip() == ""):
            deduped.append(row)
            continue

        if cert_val in seen:
            # 이미 본 certification_number -> drop
            continue

        seen.add(cert_val)
        deduped.append(row)

    return deduped