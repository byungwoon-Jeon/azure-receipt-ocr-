POST_PROCESS - 날짜 추출 로직 설명서]
	1.	개요
이 모듈은 OCR 결과 텍스트(content)에서 날짜 문자열을 찾아내고, 찾아낸 값을 표준 ISO 형식(YYYY-MM-DD)으로 변환하는 역할을 수행한다.
정규표현식으로 날짜 후보를 탐색한 후, 여러 날짜 포맷을 순차적으로 적용해 실제 날짜로 변환한다.
	2.	주요 구성요소

	•	_DATE_PATTERNS: 텍스트에서 날짜를 찾기 위한 정규표현식 목록이다.
다음과 같은 형식을 지원한다.
	•	YYYY-MM-DD / YYYY/MM/DD / YYYY.MM.DD
	•	“1 July 2025”, “01 Jul 2025”
	•	“July 1 2025”, “Jul 01 2025”, “July 1, 2025”
	•	DD/MM/YYYY, MM/DD/YYYY 등 모호한 케이스까지 포함
	•	_to_iso_date(raw):
	•	raw 문자열을 입력받아 여러 날짜 형식으로 변환 시도한다.
	•	변환 성공 시 ISO 형식(YYYY-MM-DD) 문자열을 반환한다.
	•	모든 형식이 실패하면 None 반환.
	•	날짜 형식 적용 우선순위:
	1.	YYYY- 로 시작하는 형식 우선
	2.	영문 월이 포함된 형식(DMY/MDY)
	3.	DD/MM/YYYY 형태(EU/KR)
	4.	MM/DD/YYYY 형태(US)
	•	extract_date_from_content(content):
	•	content에서 날짜 후보 문자열을 검색한다.
	•	찾은 문자열을 _to_iso_date로 변환 시도한다.
	•	변환 성공 시 해당 ISO 날짜 문자열을 반환한다.
	•	모든 패턴을 시도했음에도 유효한 날짜가 없으면 None 반환.
	•	성공/실패 로그를 출력하도록 구성되어 있다.

	3.	처리 흐름 요약
(1) content가 비어 있으면 즉시 None 반환
(2) _DATE_PATTERNS 목록을 순서대로 탐색
(3) 정규표현식으로 날짜 후보 문자열을 찾는다
(4) 찾은 문자를 _to_iso_date 함수로 변환 시도
(5) 변환 성공 시 즉시 반환
(6) 변환 실패 시 다음 패턴으로 진행
(7) 모든 패턴 실패 시 None 반환
	4.	사용 목적

	•	OCR 본문에서 날짜가 여러 포맷으로 섞여 있을 때, 단일 표준 포맷으로 정규화하기 위한 작업.
	•	이후 DB 저장 시 날짜 컬럼의 일관성을 보장한다.
	•	영수증, 송장, 문서 OCR 등 다양한 문서 유형에 대응 가능하도록 폭넓은 포맷을 지원한다.

	5.	예시
content: “Payment Date: July 1, 2025”
→ 정규식 매칭: “July 1, 2025”
→ 변환 결과: “2025-07-01”

content: “거래일자: 2025/1/7”
→ 정규식 매칭: “2025/1/7”
→ 변환 결과: “2025-01-07”


POST_PROCESS - 배달주소 추출 로직 설명서]
	1.	목적
이 함수는 OCR 또는 텍스트 데이터 안에서 “배달주소”라는 라벨이 등장하는 경우, 라벨 뒤에 이어지는 실제 배달 주소만을 제한된 범위 내에서 안전하게 추출하는 것을 목표로 한다.
가게 주소 오탐, 고객 정보 누락 방지 등을 위해 과도하게 긴 전역 주소 탐지는 하지 않는다.
	2.	주요 특징

	•	“배달주소”, “배달 주소”, “배 달 주 소” 등 공백 포함 라벨도 모두 허용.
	•	“배달주소” 뒤에 :, ：, -, 공백 등 다양한 구분자를 허용한다.
	•	라벨 뒤 최대 120자까지만 추출 범위를 제한하여 오탐 방지.
	•	줄바꿈 또는 특정 스톱 토큰(전화, 연락처, 사업자, 주문, 결제, 주소:, 가게 등)이 나타나면 그 이전까지만 주소로 인정한다.
	•	의미 있는 주소 길이(5자 이상)가 아니면 무시한다.

	3.	전체 흐름 요약
(1) content 입력이 비어 있으면 None 반환.
(2) 정규표현식으로 “배달주소” 라벨을 찾고, 해당 라벨 이후 최대 120자를 window 라는 추출 후보 문자열로 확보한다.
(3) window 내에서 줄바꿈 또는 스톱 토큰 위치를 찾아 이전까지만 주소 후보로 자른다.
(4) 좌우 불필요한 공백, 구두점(., ; : - 등), 특수문자 제거 후 정리한다.
(5) 중복 공백(예: “   “)은 한 칸으로 축소한다.
(6) 정리된 주소 길이가 5자 이상이면 결과로 반환한다.
(7) 모든 후보가 부적합하면 None 반환한다.
	4.	정규표현식 설명

	•	라벨 탐지 패턴:
(배달\s주소)\s[:：-]?\s*(?P.{0,120})
의미:
	•	‘배달주소’ 또는 ‘배달 주소’를 찾는다.
	•	뒤에 :, ：, -, 공백 등이 있어도 허용한다.
	•	addr 그룹 내부에서 최대 120자까지 주소 후보 문자열을 가져온다.
	•	스톱 토큰 패턴:
(줄바꿈 | 전화 | 연락처 | 휴대폰 | 사업자 | 주문 | 결제 | 영수증 | 가게 | 상호 | 주소: | 배송지 | 수령지)
이 단어들이 나오면 해당 위치 이전까지만 주소로 인식한다.
예: “배달주소: 경기도 성남시 분당구 … 전화: 010-1234-5678”
→ “전화” 직전까지만 주소로 사용

	5.	후처리 규칙

	•	strip(” \t,;:.-|•·\u200b”) 를 사용해 앞뒤 공백·구두점·특수문자 제거.
	•	re.sub(r”\s{2,}”, “ “, addr) 로 중복 공백을 단일 공백으로 축소.
	•	의미 없는 주소(예: “”, “–”, “123”) 방지를 위해 최소 길이(5자) 검증.

	6.	반환값

	•	성공 시: 정제된 주소 문자열(str)
	•	실패 또는 라벨 없음: None

	7.	예시
content:
“배달주소: 서울시 강남구 테헤란로 123길 45\n전화: 010-0000-0000”
결과:
“서울시 강남구 테헤란로 123길 45”

content:
“배달주소   -   경기도 수원시 영통구 영통동 123-45 가게주소: 경기도 수원시”
결과:
“경기도 수원시 영통구 영통동 123-45”



[POST_PROCESS - 사업자등록번호 추출 로직 설명서]
	1.	목적
OCR 또는 영수증 전체 텍스트(content)에서 사업자등록번호를 안전하고 정확하게 추출해
정규화된 형태로 반환하는 기능을 담당한다.
사업자번호는 9자리 또는 10자리 숫자로 구성되며, 일반적으로 000-00-00000 형태로 표기된다.
	2.	전체 처리 흐름
(1) content가 비어 있으면 즉시 None 반환
(2) “사업자번호” 라벨 근처에서 우선 탐색
(3) 폴백으로 문서 전체에서 숫자 패턴(3-2-4 또는 3-2-5) 탐색
(4) 전화번호 및 날짜 등 오탐을 제외
(5) 숫자만 추출해 9자리 또는 10자리인 경우 정상화하여 반환
(6) 모든 후보가 부적합하면 None 반환
	3.	상세 동작 설명

3-1) 라벨 근처 우선 탐색
	•	패턴: (사업자\s등록?\s번호)\s*[:：]?\s*([0-9-\s]{7,20})
	•	‘사업자번호’, ‘사업자 등록번호’, ‘사업자등록번호’ 등 다양한 띄어쓰기와 표현을 허용한다.
	•	라벨 뒤 0~40자 범위 안에서 숫자/하이픈/공백으로 구성된 문자열 블록을 캡처한다.
	•	가장 신뢰도가 높기 때문에 라벨 근처에서 발견된 후보를 가장 먼저 사용한다.

3-2) 폴백 탐색(문서 전체 검색)
	•	패턴: \b(\d{3}[-\s]?\d{2}[-\s]?\d{4,5})\b
	•	예: 000-00-00000, 000 00 00000, 0000000000 형태 모두 허용한다.
	•	OCR에서 하이픈이 빠지거나 공백으로 치환되는 경우가 많기 때문에 공백/하이픈을 옵션 처리했다.

3-3) 후보 정제(normalize_digits)
	•	모든 숫자를 추출(digits = re.sub(r’\D+’, ‘’, s))하고 나머지는 제거한다.
	•	전화번호(01x로 시작하는 10~11자리)는 제외한다.
패턴: ^01[016789]\d{7,8}$
	•	사업자번호 규격에 맞는 숫자 길이(9자리 또는 10자리)만 허용한다.
	•	정규화 형식:
	•	10자리 → XXX-XX-XXXXX
	•	9자리 → XXX-XX-XXXX

3-4) 우선순위 적용
	•	candidates 리스트는 “라벨 근처 후보” → “폴백 후보” 순으로 채워진다.
	•	normalize 성공한 첫 번째 값을 즉시 반환한다.
	•	모든 후보가 실패하면 None을 반환한다.

	4.	반환값

	•	성공 시: 정규화된 사업자번호 문자열
예: “123-45-67890”, “123-45-6789”
	•	실패 시: None

	5.	예시

예제 1:
content:
“상호: ABC푸드\n사업자등록번호: 123 45 67890\n전화: 010-1234-5678”
결과:
“123-45-67890”

예제 2:
content:
“사업자번호  123-45-6789  주문번호 0001”
결과:
“123-45-6789”

예제 3:
content:
“전화: 010-1234-5678\n결제일: 2025-01-07”
결과:
None (사업자번호 없음)


