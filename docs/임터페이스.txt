[인터페이스 정의서]  
대상: DW ↔ RPA 간 인터페이스  
업무: 해외출장 법인카드 영수증 OCR 처리  

1. 목적  
   - DW에 업로드된 해외출장 법인카드 내역 첨부파일을 OCR 처리하여  
     요약정보 및 세부항목을 추출하고 DW에 다시 입력한다.

2. 데이터 흐름  

(1) 입력 데이터 (DW → RPA)
    - 위치: DW 내 테이블 또는 View
    - 주요 필드:
        - SYSTEM_ID        : 시스템 구분 식별자
        - FIID             : 양식 문서 고유 ID
        - LINE_INDEX       : 라인 항목 인덱스
        - ATTACH_FILE      : 라인아이템 첨부파일 링크 (영수증 단위)
        - FILE_PATH        : 공통아이템 첨부파일 링크 (내역서 단위)

(2) 처리 절차 (RPA Python)
    1) RPA는 파이썬 함수만 호출
    2) 파이썬에서 DW를 조회하여 OCR 대상 문서 목록 로딩
    3) 첨부파일 URL을 통해 영수증 이미지 다운로드
    4) DRM 해제
    5) 전처리 및 크로핑 수행
    6) Azure OCR 서비스 호출
        - 추출 대상: 총액, 영수일자, 배달주소, 사업자번호, 품목 등
    7) 결과 분기:
        - 요약 정보 → RPA_CCR_LINE_SUMM 테이블 저장
        - 세부 항목 → RPA_CCR_LINE_ITEMS 테이블 저장
            - 품목명, 단가, 수량, ITEM_INDEX 등
        - 전체 OCR 결과(JSON) → RPA_CCR_LINE_ITEMS.CONTENTS 필드에 저장

(3) 출력 데이터 (RPA → DW)
    - 저장 테이블:
        - RPA_CCR_LINE_SUMM
        - RPA_CCR_LINE_ITEMS
    - 저장 포맷:
        - 각 레코드별 필드 저장
        - OCR 전체 결과는 JSON 문자열 형태로 저장됨

3. 비고
    - 모든 로그 및 에러는 RPA 측 로그 시스템에 기록
    - DRM 해제 실패 시 해당 항목은 별도 실패 테이블 또는 로그에 남김
    - OCR 실패 시 동일

4. 기타
    - 연계 주체: RPA 시스템 → Python → DW
    - 호출 방식: RPA에서 Python 함수 직접 호출
    - Python 내에서 DB 접근 및 저장 수행